<!DOCTYPE html>
<!--
Copyright 2014 Mozilla Foundation

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->
<html dir="ltr" mozdisallowselectionprint moznomarginboxes>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="google" content="notranslate">
  <title>PDF.js viewer using built components</title>

  <style>
    body {
      background-color: #808080;
      margin: 0;
      padding: 0;
    }
  </style>

  <link rel="stylesheet" href="build/components/pdf_viewer.css">

  <!-- for legacy browsers -->
  <script src="build/components/compatibility.js"></script>
  <script src="build/pdf.js"></script>
  <script src="build/components/pdf_viewer.js"></script>
</head>

<body tabindex="1">
  <div id="viewerContainer">
    <div id="viewer" class="pdfViewer"></div>
  </div>

<script>
'use strict';



// In cases when the pdf.worker.js is located at the different folder than the
// pdf.js's one, or the pdf.js is executed via eval(), the workerSrc property
// shall be specified.
//
// PDFJS.workerSrc = '../../build/pdf.worker.js';

// Some PDFs need external cmaps.
//
// PDFJS.cMapUrl = '../../external/bcmaps/';
// PDFJS.cMapPacked = true;


// get parameters from the url query
function parseUrlQuery() {
  var query = location.search.substr(1);
  var result  = {};
  query.split("&").forEach(function(part) {
    var item = part.split("=");
    result[item[0]] = decodeURIComponent(item[1]);
  });
  return result;
}
var urlQuery  = parseUrlQuery()
var documentUrl = urlQuery['url']

documentUrl = documentUrl || '../../../web/compressed.tracemonkey-pldi-09.pdf';

console.log('documentUrl', documentUrl)

// sanity check
console.assert( PDFJS.PDFViewer && PDFJS.getDocument, 'Please build the library and components using `node make generic components`');

var container = document.getElementById('viewerContainer');
var pdfViewer = new PDFJS.PDFViewer({
  container : container
});

container.addEventListener('pagesinit', function () {
  // we can use pdfViewer now, e.g. let's change default scale.
  pdfViewer.currentScaleValue = 'page-width';
});

// Loading document.
PDFJS.getDocument(documentUrl).then(function(pdfDocument) {
  // Document loaded, specifying document for the viewer.
  pdfViewer.setDocument(pdfDocument);
});
</script>
</body>
</html>

